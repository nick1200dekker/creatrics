{% extends "base.html" %}

{% block title %}Keyword Research | Creatrics{% endblock %}

{% block seo_meta %}
<meta name="description" content="Discover trending TikTok content and analyze viral potential based on video age and engagement metrics.">
<meta name="keywords" content="TikTok trends, viral videos, trend analysis, TikTok SEO, content discovery">
{% endblock %}

{% block additional_styles %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/tiktok_keyword_research.css') }}">
{% endblock %}

{% block content %}
<div class="content-panel">
    <div class="trend-finder-wrapper">
        <!-- Header -->
        <div class="trend-header">
            <h1 class="trend-title">
                <i class="ph ph-magnifying-glass"></i>
                Keyword Research
            </h1>
            <!-- Search Mode Toggle -->
            <div class="search-mode-toggle">
                <button class="mode-btn active" onclick="setSearchMode('top')" id="topModeBtn">
                    <i class="ph ph-trophy"></i>
                    Top Videos
                </button>
                <button class="mode-btn" onclick="setSearchMode('video')" id="videoModeBtn">
                    <i class="ph ph-video"></i>
                    All Videos
                </button>
            </div>
        </div>

        <!-- Legal Disclaimer - Collapsible -->
        <div style="margin-bottom: 1rem;">
            <details style="background: #fff3cd; border-left: 4px solid #ffc107; border-radius: 8px; overflow: hidden;">
                <summary style="padding: 0.75rem 1rem; cursor: pointer; font-size: 0.875rem; color: #856404; font-weight: 500; user-select: none;">
                    ⚠️ Data Source Notice (click to expand)
                </summary>
                <div style="padding: 0 1rem 1rem 1rem; color: #856404; font-size: 0.85rem; line-height: 1.5;">
                    <p style="margin: 0.5rem 0 0 0;">
                        TikTok data is collected from publicly available sources via third-party aggregation services.
                        Data may not be real-time or 100% accurate. Creatrics is not affiliated with TikTok.
                    </p>
                </div>
            </details>
        </div>

        <!-- Search Section -->
        <div class="search-section">

            <div class="search-box">
                <div class="search-input-wrapper">
                    <i class="ph ph-magnifying-glass search-icon"></i>
                    <input
                        type="text"
                        id="keywordInput"
                        class="keyword-input"
                        placeholder="Enter a keyword (e.g., Clash Royale, cooking, fitness)"
                        autocomplete="off"
                    >
                    <button id="searchBtn" class="search-button" onclick="searchTrends()">
                        <i class="ph ph-sparkle"></i>
                        <span>Analyze Trends</span>
                    </button>
                </div>
            </div>
        </div>

        <!-- Loading State -->
        <div class="loading-container" id="loadingContainer" style="display: none;">
            <div class="loading-spinner">
                <i class="ph ph-spinner spin"></i>
                <p>Analyzing TikTok trends...</p>
            </div>
        </div>

        <!-- Empty State -->
        <div class="empty-state" id="emptyState">
            <div class="empty-icon">
                <i class="ph ph-trend-up"></i>
            </div>
            <h3>Search for TikTok Trends</h3>
            <p>Enter a keyword above to discover trending videos and analyze their viral potential</p>
        </div>

        <!-- Results Section -->
        <div class="results-section" id="resultsSection" style="display: none;">
            <!-- Score Panel -->
            <div class="score-panel">
                <div class="score-card total">
                    <div class="score-header">
                        <div class="score-icon">
                            <i class="ph ph-trophy"></i>
                        </div>
                        <div class="score-label">Total Score</div>
                    </div>
                    <div class="score-value" id="totalScoreValue">0</div>
                    <div class="score-bar">
                        <div class="score-bar-fill" id="totalScoreBar" style="width: 0%"></div>
                    </div>
                </div>

                <div class="score-card hot">
                    <div class="score-header">
                        <div class="score-icon">
                            <i class="ph ph-flame"></i>
                        </div>
                        <div class="score-label">Hot Score</div>
                    </div>
                    <div class="score-value" id="hotScoreValue">0</div>
                    <div class="score-bar">
                        <div class="score-bar-fill" id="hotScoreBar" style="width: 0%"></div>
                    </div>
                </div>

                <div class="score-card engagement">
                    <div class="score-header">
                        <div class="score-icon">
                            <i class="ph ph-rocket"></i>
                        </div>
                        <div class="score-label">Engagement Score</div>
                    </div>
                    <div class="score-value" id="engagementScoreValue">0</div>
                    <div class="score-bar">
                        <div class="score-bar-fill" id="engagementScoreBar" style="width: 0%"></div>
                    </div>
                </div>
            </div>

            <!-- Trend Summary -->
            <div class="trend-summary">
                <i class="ph ph-lightbulb"></i>
                <div class="trend-summary-text" id="trendSummary">Loading trend analysis...</div>
            </div>

            <!-- Sort Toggle -->
            <div class="sort-toggle" style="margin-bottom: 1.5rem; margin-left: auto;">
                <button class="sort-btn active" onclick="setSortMode('views')" id="viewsSortBtn">
                    <i class="ph ph-eye"></i>
                    Views
                </button>
                <button class="sort-btn" onclick="setSortMode('date')" id="dateSortBtn">
                    <i class="ph ph-calendar"></i>
                    Date
                </button>
            </div>

            <!-- Videos Grid -->
            <div class="videos-grid" id="videosGrid">
                <!-- Video cards will be populated here -->
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script src="{{ url_for('static', filename='scripts/tiktok_keyword_research.js') }}"></script>
{% endblock %}