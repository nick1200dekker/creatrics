{% extends "base.html" %}

{% block title %}News Tracker - Creatrics{% endblock %}

{% block additional_styles %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/news_tracker.css') }}">
{% endblock %}

{% block content %}
<div class="news-tracker-wrapper">
    <!-- Header -->
    <div class="news-tracker-header">
        <h1 class="news-tracker-title">
            <i class="ph ph-newspaper"></i>
            News Tracker
        </h1>
    </div>

    <!-- Main Content -->
    <div class="news-tracker-content">
        <!-- Tabs -->
        <div class="tabs-container">
            <button class="tab-btn active" data-tab="for-you">
                <i class="ph ph-user"></i>
                For You
            </button>
            <button class="tab-btn" data-tab="categories">
                <i class="ph ph-folders"></i>
                Categories
            </button>
            <button class="tab-btn" data-tab="live-feeds">
                <i class="ph ph-rss"></i>
                Live Feeds
            </button>
            <button class="tab-btn" data-tab="settings">
                <i class="ph ph-gear"></i>
                Settings
            </button>
        </div>

        <!-- Tab Content: For You -->
        <div class="tab-content active" id="for-you-tab">
            <div class="main-panel">
                <div class="panel-header">
                    <div class="panel-title-section">
                        <h2 class="panel-title">
                            <i class="ph ph-sparkle"></i>
                            Personalized Feed
                        </h2>
                    </div>
                    <div class="panel-controls">
                        <button class="primary-btn" id="refreshForYou">
                            <i class="ph ph-arrows-clockwise"></i>
                            Refresh
                        </button>
                    </div>
                </div>
                <div class="panel-content">
                    <div id="forYouLoading" class="progress-section">
                        <div class="progress-card">
                            <div class="progress-header">
                                <div class="progress-icon">
                                    <i class="ph ph-spinner"></i>
                                </div>
                                <h2 class="progress-title">Loading your personalized feed...</h2>
                                <p class="progress-subtitle">Fetching articles based on your interests</p>
                            </div>
                        </div>
                    </div>
                    <div id="forYouList" class="news-list" style="display: none;"></div>
                    <div id="forYouEmpty" class="empty-state" style="display: none;">
                        <i class="ph ph-newspaper empty-icon"></i>
                        <h3 class="empty-title">No articles found</h3>
                        <p class="empty-text">Subscribe to categories in Settings to see personalized content</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Tab Content: Categories -->
        <div class="tab-content" id="categories-tab">
            <div class="main-panel">
                <div class="panel-header">
                    <div class="panel-title-section">
                        <h2 class="panel-title">
                            <i class="ph ph-folders"></i>
                            Browse by Category
                        </h2>
                    </div>
                </div>
                <div class="panel-content">
                    <!-- Category Grid -->
                    <div id="categoryBubbles" class="category-bubbles-grid" style="margin-bottom: 1.5rem;">
                        <!-- Categories will be loaded dynamically as clickable bubbles -->
                    </div>

                    <div id="categoryLoading" class="progress-section" style="display: none;">
                        <div class="progress-card">
                            <div class="progress-header">
                                <div class="progress-icon">
                                    <i class="ph ph-spinner"></i>
                                </div>
                                <h2 class="progress-title">Loading category...</h2>
                                <p class="progress-subtitle">Fetching articles from this category</p>
                            </div>
                        </div>
                    </div>
                    <div id="categoryList" class="news-list" style="display: none;"></div>
                    <div id="categoryEmpty" class="empty-state">
                        <i class="ph ph-folders empty-icon"></i>
                        <h3 class="empty-title">Select a category</h3>
                        <p class="empty-text">Click on a category above to view articles</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Tab Content: Live Feeds (existing RSS viewer) -->
        <div class="tab-content" id="live-feeds-tab">
            <div class="main-panel">
                <div class="panel-header">
                    <div class="panel-title-section">
                        <h2 class="panel-title">
                            <i class="ph ph-rss"></i>
                            Live RSS Feeds
                        </h2>
                    </div>
                    <div class="panel-controls">
                        <div class="dropdown">
                            <button class="dropdown-trigger" id="feedDropdown">
                                <span id="selectedFeed">BBC News</span>
                                <i class="ph ph-caret-down dropdown-arrow"></i>
                            </button>
                            <div class="dropdown-menu" id="feedMenu">
                                <div class="dropdown-option" data-feed="https://feeds.bbci.co.uk/news/rss.xml" data-name="BBC News">
                                    <i class="ph ph-check"></i>
                                    <span>BBC News</span>
                                </div>
                            </div>
                        </div>
                        <button class="primary-btn" id="fetchLiveFeed">
                            <i class="ph ph-arrows-clockwise"></i>
                            Fetch News
                        </button>
                    </div>
                </div>
                <div class="panel-content">
                    <div id="liveFeedLoading" class="progress-section" style="display: none;">
                        <div class="progress-card">
                            <div class="progress-header">
                                <div class="progress-icon">
                                    <i class="ph ph-spinner"></i>
                                </div>
                                <h2 class="progress-title">Fetching latest news...</h2>
                                <p class="progress-subtitle">Loading articles from RSS feed</p>
                            </div>
                        </div>
                    </div>
                    <div id="liveFeedList" class="news-list" style="display: none;"></div>
                </div>
            </div>
        </div>

        <!-- Tab Content: Settings -->
        <div class="tab-content" id="settings-tab">
            <div class="main-panel">
                <div class="panel-header">
                    <div class="panel-title-section">
                        <h2 class="panel-title">
                            <i class="ph ph-gear"></i>
                            Category Subscriptions
                        </h2>
                    </div>
                    <div class="panel-controls">
                        <button class="primary-btn" id="saveSubscriptions">
                            <i class="ph ph-check"></i>
                            Save Preferences
                        </button>
                    </div>
                </div>
                <div class="panel-content">
                    <p style="color: var(--text-secondary); margin-bottom: 1.5rem;">
                        Select the categories you're interested in to personalize your "For You" feed.
                    </p>
                    <div id="categoriesGrid" class="categories-grid">
                        <!-- Categories checkboxes will be loaded here -->
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script src="{{ url_for('static', filename='scripts/news_tracker.js') }}"></script>
{% endblock %}
