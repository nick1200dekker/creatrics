{% extends "base.html" %}

{% block title %}Keyword Research - Find YouTube Keywords | Creatrics{% endblock %}

{% block seo_meta %}
<meta name="description" content="Discover high-opportunity YouTube keywords with autocomplete suggestions and competition analysis.">
<meta name="keywords" content="YouTube keyword research, keyword tool, search volume, competition analysis, video SEO">
{% endblock %}

{% block additional_styles %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/keyword_research.css') }}">
{% endblock %}

{% block content %}
<div class="content-panel">
    <div class="keyword-research-wrapper">
        <!-- Header with Toggle -->
        <div class="research-header">
            <h1 class="research-title">
                <i class="ph ph-magnifying-glass"></i>
                Keyword Research
            </h1>
            <div class="mode-toggle">
                <button class="mode-btn active" data-mode="manual" onclick="switchMode('manual')" id="manualBtn">
                    <i class="ph ph-magnifying-glass"></i>
                    Manual
                </button>
                <button class="mode-btn" data-mode="ai" onclick="switchMode('ai')" id="aiBtn">
                    <i class="ph ph-magic-wand"></i>
                    AI Explorer
                </button>
            </div>
        </div>

        <!-- Latest Research Card (only shown in AI mode when available) -->
        <div id="latestResearchSection" class="latest-analysis-section" style="display: none;">
            <div class="latest-analysis-card" onclick="loadLatestResearch()">
                <div class="latest-analysis-icon">
                    <i class="ph ph-clock-counter-clockwise"></i>
                </div>
                <div class="latest-analysis-content">
                    <div class="latest-analysis-title">Latest Research</div>
                    <div class="latest-analysis-meta">
                        <span class="latest-analysis-detail">
                            <i class="ph ph-tag"></i>
                            <span id="latestResearchTopic">—</span>
                        </span>
                        <span class="latest-analysis-detail">
                            <i class="ph ph-list-bullets"></i>
                            <span id="latestResearchKeywordCount">—</span> keywords
                        </span>
                        <span class="latest-analysis-detail">
                            <i class="ph ph-calendar"></i>
                            <span id="latestResearchDate">—</span>
                        </span>
                    </div>
                </div>
                <button class="latest-analysis-btn">
                    <i class="ph ph-arrow-right"></i>
                </button>
            </div>
        </div>

        <!-- MANUAL MODE SECTION -->
        <div id="manualSection" style="display: block;">
            <!-- Search Section for Manual Mode -->
            <div class="search-section">
                <div class="search-box">
                    <div class="search-input-wrapper">
                        <i class="ph ph-magnifying-glass search-icon"></i>
                        <input
                            type="text"
                            id="manualKeywordInput"
                            class="keyword-input"
                            placeholder="Enter a keyword to research (e.g., clash royale, minecraft, cooking)"
                            autocomplete="off"
                        >
                        <button id="manualExploreBtn" class="explore-button" onclick="exploreKeyword()">
                            <i class="ph ph-sparkle"></i>
                            <span>Explore</span>
                        </button>
                    </div>
                </div>

                <!-- Breadcrumb Trail (only for manual mode) -->
                <div class="breadcrumb-trail" id="breadcrumbTrail" style="display: none;">
                    <div class="breadcrumb-items" id="breadcrumbItems"></div>
                </div>
            </div>
            <!-- Loading State -->
            <div class="loading-container" id="manualLoadingContainer" style="display: none;">
                <div class="loading-spinner">
                    <i class="ph ph-spinner spin"></i>
                    <span class="loading-text">Analyzing keywords...</span>
                </div>
            </div>

            <!-- Results Section -->
            <div class="results-section" id="manualResultsSection" style="display: none;">
                <!-- Current Keyword Analysis -->
                <div class="keyword-analysis-card">
                    <div class="analysis-header">
                        <h2 class="analyzed-keyword" id="analyzedKeyword"></h2>
                        <span class="opportunity-badge" id="opportunityBadge"></span>
                    </div>

                    <!-- Quality Warning -->
                    <div class="quality-warning" id="qualityWarning" style="display: none;"></div>

                    <div class="metrics-grid">
                        <div class="metric-card">
                            <div class="metric-icon competition">
                                <i class="ph ph-stack"></i>
                            </div>
                            <div class="metric-content">
                                <div class="metric-label">Competition</div>
                                <div class="metric-value" id="competitionLevel">-</div>
                            </div>
                        </div>

                        <div class="metric-card">
                            <div class="metric-icon views">
                                <i class="ph ph-fire"></i>
                            </div>
                            <div class="metric-content">
                                <div class="metric-label">Search Interest</div>
                                <div class="metric-value" id="interestLevel">-</div>
                            </div>
                        </div>

                        <div class="metric-card">
                            <div class="metric-icon score">
                                <i class="ph ph-target"></i>
                            </div>
                            <div class="metric-content">
                                <div class="metric-label">Opportunity Score</div>
                                <div class="metric-value opportunity-score" id="opportunityScore">-</div>
                                <div class="metric-sublabel">Interest + Competition</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Related Keywords Section -->
                <div class="related-keywords-section">
                    <div class="section-header">
                        <h3>
                            <i class="ph ph-lightbulb"></i>
                            Related Keywords
                        </h3>
                    </div>

                    <div class="keywords-grid" id="keywordsGrid">
                        <!-- Keywords will be populated here -->
                    </div>
                </div>
            </div>

            <!-- Empty State -->
            <div class="empty-state" id="manualEmptyState">
                <div class="empty-icon">
                    <i class="ph ph-magnifying-glass"></i>
                </div>
                <h3>Start Your Keyword Research</h3>
                <p>Enter a keyword above to discover related search terms and competition metrics</p>
            </div>
        </div>

        <!-- AI EXPLORER MODE SECTION -->
        <div id="aiSection" style="display: none;">
            <!-- Search Section for AI Mode -->
            <div class="search-section">
                <div class="search-box">
                    <div class="search-input-wrapper">
                        <i class="ph ph-magic-wand search-icon"></i>
                        <input
                            type="text"
                            id="aiKeywordInput"
                            class="keyword-input"
                            placeholder="Enter a topic (e.g., Fortnite, Yoga, AI Video Models)"
                            autocomplete="off"
                        >
                        <button id="aiExploreBtn" class="explore-button" onclick="exploreKeyword()">
                            <i class="ph ph-sparkle"></i>
                            <span>Generate & Analyze</span>
                        </button>
                    </div>
                </div>
            </div>

            <!-- Loading State -->
            <div class="loading-container" id="aiLoadingContainer" style="display: none;">
                <div class="loading-spinner">
                    <i class="ph ph-spinner spin"></i>
                    <span class="loading-text">Analyzing keywords...</span>
                </div>
            </div>

            <!-- Results Section -->
            <div class="results-section" id="aiResultsSection" style="display: none;">
                <!-- AI Insights -->
                <div class="ai-insights-card" id="aiInsightsCard" style="display: none;">
                    <div class="insights-header">
                        <h3>
                            <i class="ph ph-lightbulb"></i>
                            AI Insights
                        </h3>
                        <div class="insights-meta" id="insightsMeta"></div>
                    </div>
                    <div class="insights-content" id="insightsContent"></div>
                </div>

                <!-- Related Keywords Section -->
                <div class="related-keywords-section">
                    <div class="section-header">
                        <h3 id="aiKeywordsTitle">
                            <i class="ph ph-lightbulb"></i>
                            Keyword Opportunities
                        </h3>
                    </div>

                    <div class="keywords-grid" id="aiKeywordsGrid">
                        <!-- Keywords table will be populated here -->
                    </div>
                </div>
            </div>

            <!-- Empty State -->
            <div class="empty-state" id="aiEmptyState">
                <div class="empty-icon">
                    <i class="ph ph-magic-wand"></i>
                </div>
                <h3>AI-Powered Keyword Discovery</h3>
                <p>Enter a topic above and let AI generate and analyze 50 keyword opportunities for you</p>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script src="{{ url_for('static', filename='scripts/keyword_research.js') }}"></script>
{% endblock %}