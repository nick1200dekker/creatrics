{% extends "base.html" %}

{% block title %}Analyze Video - AI-Powered YouTube Analysis | Creatrics{% endblock %}

{% block seo_meta %}
<meta name="description" content="Analyze any YouTube video with AI. Get detailed insights on hooks, content strategy, SEO, and more. Deep dive into video performance and creator strategies.">
<meta name="keywords" content="YouTube video analysis, video insights, content strategy, YouTube AI analysis, video analytics">
{% endblock %}

{% block additional_styles %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/analyze_video.css') }}">
{% endblock %}

{% block content %}
<div class="content-panel">
    <div class="analyze-video-wrapper">
    <!-- Header -->
    <div class="analyze-header">
        <h1 class="analyze-title">
            <i class="ph ph-video"></i>
            Analyze / Search Videos
        </h1>
    </div>

    <!-- Content Area -->
    <div class="analyze-content">
        <!-- Input Section -->
        <div class="input-section">
            <div class="input-card">
                <div class="input-header">
                    <div style="display: flex; justify-content: space-between; align-items: center; width: 100%;">
                        <h2 class="input-title">
                            <i class="ph ph-video"></i>
                            Analyze Content
                        </h2>
                        <div class="view-toggle">
                            <button class="toggle-btn active" onclick="switchInputView('search')" id="searchToggleBtn">
                                <i class="ph ph-magnifying-glass"></i>
                                Search Videos
                            </button>
                            <button class="toggle-btn" onclick="switchInputView('url')" id="urlToggleBtn">
                                <i class="ph ph-link"></i>
                                YouTube URL
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Content Type Toggle (Videos/Shorts) - Only for Search -->
                <div id="contentTypeToggle" style="margin-bottom: 1rem;">
                    <div style="display: flex; gap: 1rem; flex-wrap: wrap; align-items: center;">
                        <div class="view-toggle">
                            <button class="toggle-btn active" onclick="switchContentType('videos')" id="videosToggleBtn">
                                <i class="ph ph-video"></i>
                                Videos
                            </button>
                            <button class="toggle-btn" onclick="switchContentType('shorts')" id="shortsToggleBtn">
                                <i class="ph ph-device-mobile"></i>
                                Shorts
                            </button>
                        </div>
                        <div class="view-toggle" id="sortToggle">
                            <button class="toggle-btn active" onclick="switchSortBy('relevance')" id="relevanceSortBtn">
                                <i class="ph ph-star"></i>
                                Relevance
                            </button>
                            <button class="toggle-btn" onclick="switchSortBy('date')" id="dateSortBtn">
                                <i class="ph ph-calendar"></i>
                                Latest
                            </button>
                        </div>
                    </div>
                </div>

                <!-- URL Input View -->
                <div class="input-view" id="urlInputView" style="display: none;">
                    <div class="url-input-group">
                        <input
                            type="text"
                            id="videoUrl"
                            placeholder="https://www.youtube.com/watch?v=... or https://youtube.com/shorts/..."
                            class="url-input"
                        >
                        <button onclick="analyzeFromUrl()" class="analyze-btn">
                            <i class="ph ph-magnifying-glass-plus"></i>
                            Analyze
                        </button>
                    </div>
                </div>

                <!-- Search Input View -->
                <div class="input-view" id="searchInputView">
                    <div class="search-input-group">
                        <input
                            type="text"
                            id="searchQuery"
                            placeholder="Search for videos or shorts..."
                            class="search-input"
                            onkeypress="if(event.key==='Enter') searchVideos()"
                        >
                        <button onclick="searchVideos()" class="search-btn">
                            <i class="ph ph-magnifying-glass"></i>
                            Search
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Progress Section (hidden by default, shown during analysis) -->
        <div class="progress-section" id="progressSection" style="display: none;">
            <div class="progress-card">
                <div class="progress-header">
                    <div class="progress-icon">
                        <i class="ph ph-spinner spin"></i>
                    </div>
                    <h2 class="progress-title">Analyzing Video</h2>
                    <p class="progress-subtitle">This may take a moment while we analyze the video...</p>
                </div>
            </div>
        </div>

        <!-- Search Results -->
        <div id="searchResults" class="search-results" style="display: none;">
            <h3 class="section-title">
                <i class="ph ph-video"></i>
                Search Results
            </h3>
            <div id="searchResultsGrid" class="results-grid">
                <!-- Results will be populated here -->
            </div>
        </div>

        <!-- History -->
        <div class="history-section" id="historySection" style="margin-top: 8rem;">
            <h3 class="section-title">
                <i class="ph ph-clock-counter-clockwise"></i>
                Recent Analyses
            </h3>
            <div id="historyGrid" class="history-grid">
                <!-- History will be populated here -->
            </div>
            <div id="emptyHistory" class="empty-state" style="display: none;">
                <i class="ph ph-video"></i>
                <p>No video analyses yet</p>
                <span>Start by analyzing a video above</span>
            </div>
        </div>
    </div>
</div>
</div>
{% endblock %}

{% block scripts %}
<script src="{{ url_for('static', filename='scripts/analyze_video.js') }}"></script>
{% endblock %}