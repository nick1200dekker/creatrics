<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>500 - Server Error | Creatrics</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/@phosphor-icons/web"></script>
    <style>
        :root {
            --bg-primary: #F8FAFC;
            --bg-secondary: rgba(255, 255, 255, 0.95);
            --text-primary: #1E293B;
            --text-secondary: #64748B;
            --border-color: rgba(239, 68, 68, 0.2);

            --brand-gradient: #3B82F6;
            --error-gradient: linear-gradient(135deg, #EF4444 0%, #F97316 50%, #EC4899 100%);
            --soft-gradient: linear-gradient(135deg, #FEE2E2 0%, #FED7AA 50%, #FCE7F3 100%);
            --status-bg: linear-gradient(135deg, rgba(254, 226, 226, 0.8) 0%, rgba(254, 215, 170, 0.8) 100%);
            --accent-blue: #3B82F6;
            --accent-purple: #3B82F6;
            --accent-pink: #2563EB;
            --accent-red: #EF4444;

            --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
            --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            --shadow-xl: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);

            --gradient-opacity: 0.04;
        }

        /* Dark mode - consistent with base.html */
        html.dark {
            --bg-primary: #18181b;
            --bg-secondary: #27272a;
            --text-primary: #fafafa;
            --text-secondary: #d4d4d8;
            --border-color: rgba(239, 68, 68, 0.3);

            --soft-gradient: linear-gradient(135deg, rgba(254, 226, 226, 0.15) 0%, rgba(254, 215, 170, 0.15) 100%);
            --status-bg: linear-gradient(135deg, rgba(254, 226, 226, 0.1) 0%, rgba(254, 215, 170, 0.1) 100%);

            --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.3);
            --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.4), 0 2px 4px -1px rgba(0, 0, 0, 0.3);
            --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.4), 0 4px 6px -2px rgba(0, 0, 0, 0.3);
            --shadow-xl: 0 20px 25px -5px rgba(0, 0, 0, 0.4), 0 10px 10px -5px rgba(0, 0, 0, 0.3);

            --gradient-opacity: 0.08;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            min-height: 100vh;
            overflow-x: hidden;
            opacity: 0;
            transition: opacity 0.5s ease, background-color 0.3s ease, color 0.3s ease;
        }

        body.loaded {
            opacity: 1;
        }

        /* Theme toggle */
        .theme-toggle {
            position: fixed;
            top: 2rem;
            right: 2rem;
            z-index: 1000;
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 0.75rem;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: var(--shadow-md);
            transition: all 0.3s ease;
        }

        .theme-toggle:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }

        .theme-toggle i {
            font-size: 1.5rem;
            color: var(--text-primary);
            transition: transform 0.3s ease;
        }

        .theme-toggle:hover i {
            transform: rotate(20deg);
        }

        /* Animated background */
        .animated-bg {
            position: fixed;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            z-index: -1;
            background: var(--bg-primary);
            overflow: hidden;
            transition: background-color 0.3s ease;
        }

        .animated-bg::before {
            content: '';
            position: absolute;
            width: 100%;
            height: 100%;
            background-image:
                radial-gradient(circle at 20% 80%, rgba(239, 68, 68, var(--gradient-opacity)) 0%, transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(249, 115, 22, var(--gradient-opacity)) 0%, transparent 50%),
                radial-gradient(circle at 40% 40%, rgba(236, 72, 153, var(--gradient-opacity)) 0%, transparent 50%);
            opacity: 0.6;
            animation: bgShift 20s ease-in-out infinite;
        }

        @keyframes bgShift {
            0%, 100% { transform: translate(0, 0) rotate(0deg); }
            33% { transform: translate(-15px, -15px) rotate(0.5deg); }
            66% { transform: translate(15px, -8px) rotate(-0.5deg); }
        }

        /* Floating error elements */
        .floating-error {
            position: absolute;
            font-size: 2rem;
            opacity: 0.15;
            animation: floatError 18s infinite linear;
            pointer-events: none;
            user-select: none;
            color: #EF4444;
        }

        @keyframes floatError {
            0% {
                transform: translateY(100vh) rotate(0deg);
                opacity: 0;
            }
            10% {
                opacity: 0.15;
            }
            90% {
                opacity: 0.15;
            }
            100% {
                transform: translateY(-100px) rotate(360deg);
                opacity: 0;
            }
        }

        /* Main container */
        .error-page {
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 2rem;
            position: relative;
        }

        /* Error container */
        .error-container {
            background: var(--bg-secondary);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border-radius: 20px;
            padding: 3rem;
            box-shadow: var(--shadow-xl);
            border: 1px solid var(--border-color);
            position: relative;
            overflow: hidden;
            max-width: 600px;
            width: 100%;
            text-align: center;
            opacity: 0;
            transform: translateY(30px);
            transition: all 0.6s ease, background-color 0.3s ease;
        }

        .error-container.active {
            opacity: 1;
            transform: translateY(0);
        }

        .error-container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: var(--error-gradient);
            opacity: 0.8;
        }

        /* Error icon */
        .error-icon {
            width: 120px;
            height: 120px;
            background: var(--soft-gradient);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 2rem;
            font-size: 3rem;
            color: var(--accent-red);
            box-shadow: 0 10px 30px rgba(239, 68, 68, 0.3);
            animation: shake 2s ease-in-out infinite;
        }

        @keyframes shake {
            0%, 50%, 100% {
                transform: translateX(0);
            }
            10%, 30% {
                transform: translateX(-5px);
            }
            20%, 40% {
                transform: translateX(5px);
            }
        }

        /* Typography */
        .error-number {
            font-size: 5rem;
            font-weight: 900;
            background: var(--error-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 1rem;
            line-height: 1;
            letter-spacing: -0.02em;
        }

        .error-title {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 1rem;
            color: var(--text-primary);
        }

        .error-description {
            font-size: 1.125rem;
            color: var(--text-secondary);
            margin-bottom: 2.5rem;
            line-height: 1.6;
        }

        /* Buttons */
        .error-buttons {
            display: flex;
            gap: 1rem;
            justify-content: center;
            flex-wrap: wrap;
        }

        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            padding: 1rem 2rem;
            border-radius: 12px;
            font-weight: 600;
            font-size: 1rem;
            text-decoration: none;
            border: none;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .btn-primary {
            background: var(--brand-gradient);
            color: white;
            box-shadow: var(--shadow-md);
        }

        .btn-primary::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: rgba(255, 255, 255, 0.2);
            transition: left 0.6s ease;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }

        .btn-primary:hover::before {
            left: 100%;
        }

        .btn-refresh {
            background: var(--error-gradient);
            color: white;
            box-shadow: 0 8px 25px rgba(239, 68, 68, 0.4);
        }

        .btn-refresh:hover {
            transform: translateY(-2px);
            box-shadow: 0 12px 35px rgba(239, 68, 68, 0.5);
        }

        .btn-refresh.loading {
            pointer-events: none;
            opacity: 0.8;
        }

        .btn-refresh.loading i {
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        /* Status section */
        .status-section {
            margin-top: 2rem;
            padding: 1.5rem;
            background: var(--status-bg);
            border-radius: 16px;
            border: 1px solid var(--border-color);
            opacity: 0;
            transform: translateY(10px);
            transition: all 0.4s ease, background 0.3s ease;
        }

        .status-section.active {
            opacity: 1;
            transform: translateY(0);
        }

        .status-title {
            font-weight: 700;
            color: var(--accent-red);
            margin-bottom: 0.5rem;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
        }

        .status-text {
            color: var(--text-secondary);
            font-size: 0.95rem;
        }

        /* Auto-retry countdown */
        .retry-countdown {
            margin-top: 1rem;
            font-size: 0.875rem;
            color: var(--text-secondary);
            opacity: 0;
            transition: opacity 0.4s ease;
        }

        .retry-countdown.active {
            opacity: 1;
        }

        .countdown-number {
            font-weight: 700;
            color: var(--accent-red);
        }

        /* Page transition */
        .page-transition {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: var(--bg-primary);
            z-index: 9999;
            transition: opacity 0.3s ease, background-color 0.3s ease;
            opacity: 0;
            pointer-events: none;
        }

        .page-transition.active {
            opacity: 1;
            pointer-events: all;
        }

        /* Mobile responsive */
        @media (max-width: 768px) {
            .theme-toggle {
                top: 1rem;
                right: 1rem;
            }

            .error-container {
                padding: 2rem;
            }

            .error-number {
                font-size: 4rem;
            }

            .error-title {
                font-size: 1.5rem;
            }

            .error-buttons {
                flex-direction: column;
                align-items: center;
            }

            .btn {
                width: 100%;
                max-width: 250px;
                justify-content: center;
            }
        }
    </style>
</head>
<body>
    <!-- Theme toggle -->
    <button class="theme-toggle" onclick="toggleTheme()" title="Toggle theme">
        <i class="ph ph-sun" id="theme-icon"></i>
    </button>

    <!-- Page transition overlay -->
    <div id="page-transition" class="page-transition"></div>

    <!-- Animated background -->
    <div class="animated-bg">
        <!-- Floating Error Elements -->
        <div class="floating-error" style="left: 10%; animation-delay: 0s;">‚ö†Ô∏è</div>
        <div class="floating-error" style="left: 25%; animation-delay: 4s;">üîß</div>
        <div class="floating-error" style="left: 40%; animation-delay: 8s;">üí•</div>
        <div class="floating-error" style="left: 60%; animation-delay: 12s;">üõ†Ô∏è</div>
        <div class="floating-error" style="left: 75%; animation-delay: 16s;">‚õî</div>
        <div class="floating-error" style="left: 90%; animation-delay: 20s;">üîÑ</div>
    </div>

    <!-- Main Error Container -->
    <div class="error-page">
        <div class="error-container" id="error-container">
            <div class="error-icon">
                <i class="ph ph-warning-circle"></i>
            </div>

            <div class="error-number">500</div>
            <h1 class="error-title">Server Error</h1>
            <p class="error-description">
                Oops! Our creative servers are taking a moment.
                Even the best AI assistants need a break sometimes. We're working on getting Creatrics back up and running!
            </p>

            <div class="error-buttons">
                <button onclick="refreshPage()" class="btn btn-refresh" id="refresh-btn">
                    <i class="ph ph-arrow-clockwise"></i>
                    Try Again
                </button>
                <a href="{{ url_for('home.dashboard') }}" class="btn btn-primary" id="home-btn">
                    <i class="ph ph-house"></i>
                    Back to Home
                </a>
            </div>

            <div class="status-section" id="status-section">
                <div class="status-title">
                    <i class="ph ph-gear"></i>
                    What's Happening?
                </div>
                <div class="status-text">
                    Our servers are experiencing some technical difficulties. This usually resolves itself quickly,
                    but if the problem persists, our team has been automatically notified and is working on a fix.
                </div>
                <div class="retry-countdown" id="retry-countdown">
                    Auto-retry in <span class="countdown-number" id="countdown">30</span> seconds
                </div>
            </div>
        </div>
    </div>

    <script>
        // Apply dark mode immediately to prevent flash
        if (localStorage.getItem('darkMode') === 'true') {
            document.documentElement.classList.add('dark');
        }

        // Theme management
        function toggleTheme() {
            const isDark = document.documentElement.classList.toggle('dark');
            localStorage.setItem('darkMode', isDark);
            updateThemeIcon();
        }

        function updateThemeIcon() {
            const icon = document.getElementById('theme-icon');
            if (icon) {
                const isDark = document.documentElement.classList.contains('dark');
                icon.className = isDark ? 'ph ph-moon' : 'ph ph-sun';
            }
        }

        // Initialize theme icon
        window.addEventListener('DOMContentLoaded', () => updateThemeIcon());

        // Page load animation
        document.addEventListener('DOMContentLoaded', function() {
            setTimeout(() => {
                document.body.classList.add('loaded');
                document.getElementById('error-container').classList.add('active');

                setTimeout(() => {
                    document.getElementById('status-section').classList.add('active');

                    // Start countdown if enabled
                    if (window.enableAutoRetry) {
                        setTimeout(() => {
                            document.getElementById('retry-countdown').classList.add('active');
                            startCountdown();
                        }, 300);
                    }
                }, 300);
            }, 100);
        });

        // Create more floating error elements dynamically
        function createFloatingError() {
            const errorEmojis = ['‚ö†Ô∏è', 'üîß', 'üí•', 'üõ†Ô∏è', '‚õî', 'üîÑ', '‚ö°', 'üö®', 'üî•', 'üí≠'];
            const error = document.createElement('div');
            error.className = 'floating-error';
            error.textContent = errorEmojis[Math.floor(Math.random() * errorEmojis.length)];
            error.style.left = Math.random() * 100 + '%';
            error.style.animationDuration = (Math.random() * 12 + 15) + 's';
            error.style.fontSize = (Math.random() * 1 + 1.5) + 'rem';
            document.querySelector('.animated-bg').appendChild(error);

            setTimeout(() => error.remove(), 25000);
        }

        // Create new floating errors periodically
        setInterval(createFloatingError, 5000);

        // Refresh page function with loading state
        function refreshPage() {
            const refreshBtn = document.getElementById('refresh-btn');
            refreshBtn.classList.add('loading');
            refreshBtn.innerHTML = '<i class="ph ph-arrow-clockwise"></i> Refreshing...';

            // Stop countdown if running
            if (window.countdownInterval) {
                clearInterval(window.countdownInterval);
            }

            // Add a small delay to show the loading state
            setTimeout(() => {
                window.location.reload();
            }, 1000);
        }

        // Auto-retry countdown (disabled by default)
        window.enableAutoRetry = false; // Set to true to enable auto-retry
        let autoRetryTimer = 30;

        function startCountdown() {
            const updateTimer = () => {
                if (autoRetryTimer > 0) {
                    document.getElementById('countdown').textContent = autoRetryTimer;
                    autoRetryTimer--;
                } else {
                    clearInterval(window.countdownInterval);
                    refreshPage();
                }
            };

            window.countdownInterval = setInterval(updateTimer, 1000);
        }

        // Add interactive flair to error icon
        document.querySelector('.error-icon').addEventListener('click', function() {
            this.style.transform = 'scale(1.1) rotate(15deg)';
            setTimeout(() => {
                this.style.transform = '';
            }, 600);
        });

        // Page transition function
        function showPageTransition() {
            document.getElementById('page-transition').classList.add('active');
        }

        // Handle home button click with transition
        document.getElementById('home-btn').addEventListener('click', function(e) {
            e.preventDefault();
            showPageTransition();
            setTimeout(() => {
                window.location.href = this.getAttribute('href');
            }, 300);
        });

        // Server status messages (rotate every 10 seconds)
        const statusMessages = [
            {
                title: "What's Happening?",
                text: "Our servers are experiencing some technical difficulties. This usually resolves itself quickly, but if the problem persists, our team has been automatically notified and is working on a fix."
            },
            {
                title: "Server Status",
                text: "We're running diagnostics to identify the issue. Most server errors are resolved within a few minutes. Thank you for your patience while we get Creatrics back online!"
            },
            {
                title: "Quick Tip",
                text: "While you wait, why not think about your next viral content idea? Sometimes the best creative insights come from unexpected moments like this!"
            }
        ];

        let currentStatusIndex = 0;
        setInterval(() => {
            currentStatusIndex = (currentStatusIndex + 1) % statusMessages.length;
            const statusSection = document.getElementById('status-section');
            const statusTitle = statusSection.querySelector('.status-title');
            const statusText = statusSection.querySelector('.status-text');

            statusSection.style.opacity = '0';

            setTimeout(() => {
                statusTitle.innerHTML = `<i class="ph ph-gear"></i> ${statusMessages[currentStatusIndex].title}`;
                statusText.textContent = statusMessages[currentStatusIndex].text;
                statusSection.style.opacity = '1';
            }, 300);
        }, 10000);
    </script>
</body>
</html>