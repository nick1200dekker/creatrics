{% extends "base.html" %}

{% block title %}Dashboard - Creatrics{% endblock %}

{% block additional_styles %}
<style>
/* Reset default content-panel padding like Analytics */
.content-panel {
    padding: 0 !important;
    background: transparent !important;
    box-shadow: none !important;
    border: none !important;
}

/* Dashboard wrapper - full height like analytics */
.dashboard-wrapper {
    background: var(--bg-secondary);
    border-radius: 12px;
    box-shadow: var(--shadow-sm);
    border: 1px solid var(--border-secondary);
    overflow: hidden;
    width: 100%;
    min-height: calc(100vh - 60px);
    transition: background-color 0.3s ease, border-color 0.3s ease;
    position: relative;
}

/* Subtle animated background gradient */
.dashboard-wrapper::before {
    content: '';
    position: absolute;
    top: -50%;
    left: -50%;
    width: 200%;
    height: 200%;
    background: radial-gradient(circle at 20% 80%, rgba(59, 130, 246, 0.03) 0%, transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(139, 92, 246, 0.03) 0%, transparent 50%);
    pointer-events: none;
}

html.dark .dashboard-wrapper {
    border-color: transparent;
}

/* Dashboard Specific Styles */
.dashboard-container {
    padding: 2rem;
    position: relative;
    z-index: 1;
}

/* Welcome Section - Clean without animation */
.welcome-section {
    background: linear-gradient(135deg, var(--bg-secondary) 0%, rgba(59, 130, 246, 0.05) 100%);
    border-radius: 16px;
    padding: 2rem;
    margin-bottom: 2rem;
    box-shadow: var(--shadow-sm);
    border: 1px solid var(--border-secondary);
    text-align: center;
    position: relative;
    overflow: hidden;
    transition: all 0.3s ease;
}

html.dark .welcome-section {
    background: linear-gradient(135deg, var(--bg-secondary) 0%, rgba(59, 130, 246, 0.1) 100%);
    border-color: transparent;
}

.welcome-title {
    font-size: 2.25rem;
    font-weight: 800;
    color: var(--text-primary);
    margin-bottom: 0.5rem;
    line-height: 1.2;
    letter-spacing: -0.02em;
}

.welcome-title span {
    color: #3B82F6;
}

.welcome-subtitle {
    font-size: 1.125rem;
    color: var(--text-secondary);
    margin-bottom: 0;
    font-weight: 500;
}

/* Credits Section - Enhanced but cleaner */
.credits-section {
    background: linear-gradient(135deg, #3B82F6 0%, #2563EB 100%);
    color: white;
    padding: 1.5rem;
    border-radius: 16px;
    margin-bottom: 2rem;
    box-shadow: 0 10px 25px -5px rgba(59, 130, 246, 0.25);
    position: relative;
    overflow: hidden;
    transition: all 0.3s ease;
}

.credits-section:hover {
    transform: translateY(-2px);
    box-shadow: 0 15px 30px -5px rgba(59, 130, 246, 0.35);
}

html.dark .credits-section {
    background: linear-gradient(135deg, #1e40af 0%, #1e3a8a 100%);
    box-shadow: 0 10px 25px -5px rgba(30, 64, 175, 0.3);
}

.credits-section::after {
    content: '';
    position: absolute;
    bottom: -30%;
    left: -10%;
    width: 150px;
    height: 150px;
    background: rgba(255, 255, 255, 0.1);
    border-radius: 50%;
    filter: blur(40px);
}

.credits-container {
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 1.5rem;
    flex-wrap: wrap;
    position: relative;
    z-index: 1;
}

.credits-info {
    display: flex;
    align-items: center;
    gap: 1.5rem;
    transition: transform 0.2s ease;
    padding: 0.5rem;
    border-radius: 12px;
    margin: -0.5rem;
}

.credits-info:hover {
    transform: translateY(-2px);
}

.credits-avatar {
    width: 56px;
    height: 56px;
    background: rgba(255, 255, 255, 0.2);
    border-radius: 14px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.5rem;
    font-weight: 700;
    backdrop-filter: blur(10px);
    border: 2px solid rgba(255, 255, 255, 0.3);
}

.credits-details h3 {
    font-size: 0.875rem;
    font-weight: 600;
    margin-bottom: 0.25rem;
    opacity: 0.9;
    text-transform: uppercase;
    letter-spacing: 0.05em;
}

.credits-amount {
    display: flex;
    align-items: baseline;
    gap: 0.5rem;
}

.credits-number {
    font-size: 2rem;
    font-weight: 800;
    letter-spacing: -0.02em;
}

.credits-label {
    font-size: 0.875rem;
    opacity: 0.85;
}

.credits-action {
    background: rgba(255, 255, 255, 0.2);
    color: white;
    padding: 0.75rem 1.5rem;
    border-radius: 10px;
    font-weight: 600;
    text-decoration: none;
    transition: all 0.2s ease;
    backdrop-filter: blur(10px);
    border: 1px solid rgba(255, 255, 255, 0.3);
    display: inline-flex;
    align-items: center;
    gap: 0.5rem;
    font-size: 0.875rem;
}

.credits-action:hover {
    background: rgba(255, 255, 255, 0.3);
    transform: translateY(-1px);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    color: white;
}

.credits-action i {
    font-size: 1.125rem;
}

/* Guest Hero Section - Cleaner gradient */
.guest-hero {
    background: linear-gradient(135deg, rgba(59, 130, 246, 0.05) 0%, rgba(139, 92, 246, 0.05) 100%);
    padding: 3rem 2rem;
    border-radius: 24px;
    margin-bottom: 2rem;
    text-align: center;
    border: 1px solid rgba(59, 130, 246, 0.1);
    transition: background 0.3s ease, border-color 0.3s ease;
}

html.dark .guest-hero {
    background: linear-gradient(135deg, rgba(59, 130, 246, 0.1) 0%, rgba(139, 92, 246, 0.1) 100%);
    border: 1px solid rgba(59, 130, 246, 0.2);
}

.guest-hero h1 {
    font-size: 3rem;
    font-weight: 900;
    color: var(--text-primary);
    margin-bottom: 1rem;
    line-height: 1.1;
}

.guest-hero .gradient-text {
    background: linear-gradient(135deg, #3B82F6 0%, #8B5CF6 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
}

.guest-hero p {
    font-size: 1.25rem;
    color: var(--text-secondary);
    margin-bottom: 2rem;
    max-width: 600px;
    margin-left: auto;
    margin-right: auto;
}

.guest-cta-buttons {
    display: flex;
    gap: 1rem;
    justify-content: center;
    flex-wrap: wrap;
}

.guest-cta-buttons .btn-primary,
.guest-cta-buttons .btn-secondary {
    padding: 0.875rem 2rem;
    font-size: 1rem;
}

/* Platform Section - Clean with subtle enhancements */
.platform-section {
    background: var(--bg-secondary);
    border-radius: 16px;
    padding: 1.75rem;
    margin-bottom: 2rem;
    box-shadow: var(--shadow-sm);
    border: 1px solid var(--border-secondary);
    transition: all 0.3s ease;
}

html.dark .platform-section {
    border-color: transparent;
    background: var(--bg-secondary);
}

.platform-section:hover {
    transform: translateY(-2px);
    box-shadow: 0 8px 20px rgba(0, 0, 0, 0.08);
}

/* Platform Headers - Keep consistent color */
.platform-header {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    margin-bottom: 1.5rem;
    padding-bottom: 1rem;
    border-bottom: 1px solid rgba(226, 232, 240, 0.5);
}

.platform-header h2 {
    font-size: 1.5rem;
    font-weight: 700;
    color: var(--text-primary);
    letter-spacing: -0.01em;
}

.platform-header i {
    font-size: 1.75rem;
    color: #3B82F6;
    opacity: 0.8;
}

html.dark .platform-header {
    border-bottom-color: rgba(63, 63, 70, 0.5);
}

/* Features Grid - Enhanced but functional */
.features-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
    gap: 1.5rem;
}

.feature-card {
    background: var(--bg-secondary);
    border-radius: 16px;
    padding: 1.25rem;
    box-shadow: var(--shadow-sm);
    border: 1px solid var(--border-secondary);
    transition: all 0.3s ease;
    cursor: pointer;
    position: relative;
    overflow: hidden;
    text-decoration: none;
    display: block;
}

html.dark .feature-card {
    border-color: transparent;
    background: var(--bg-tertiary);
}

.feature-card::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 3px;
    background: linear-gradient(90deg, #3B82F6 0%, #8B5CF6 100%);
    transform: translateX(-100%);
    transition: transform 0.3s ease;
}

.feature-card:hover {
    transform: translateY(-4px);
    box-shadow: 0 12px 24px rgba(0, 0, 0, 0.08);
}

.feature-card:hover::before {
    transform: translateX(0);
}

.feature-card:hover .feature-icon-inline {
    color: #3B82F6;
    transform: scale(1.1);
}

.feature-icon-inline {
    font-size: 1.25rem;
    color: #64748B;
    margin-right: 0.5rem;
    vertical-align: middle;
    transition: all 0.3s ease;
}

.feature-content h3 {
    font-size: 1.25rem;
    font-weight: 700;
    color: var(--text-primary);
    margin-bottom: 0.5rem;
}

.feature-content p {
    font-size: 0.9rem;
    color: var(--text-tertiary);
    line-height: 1.6;
    margin-bottom: 0;
}

/* Coming Soon Section - Subtle and greyed out */
.coming-soon-section {
    background: var(--bg-tertiary);
    opacity: 0.7;
    transition: all 0.3s ease;
}

html.dark .coming-soon-section {
    background: var(--bg-secondary);
    opacity: 0.6;
}

.coming-soon-card {
    background: var(--bg-tertiary);
    border: 2px dashed var(--border-primary);
    opacity: 0.65;
    cursor: not-allowed;
    transition: none;
    pointer-events: none;
}

html.dark .coming-soon-card {
    background: var(--bg-tertiary);
    border-color: var(--border-primary);
}

.coming-soon-card:hover {
    transform: none;
    box-shadow: var(--shadow-sm);
}

.coming-soon-card .feature-icon-inline {
    color: #94A3B8;
}

.coming-soon-badge {
    display: inline-block;
    background: rgba(148, 163, 184, 0.1);
    color: #94A3B8;
    padding: 0.25rem 0.75rem;
    border-radius: 20px;
    font-size: 0.75rem;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.05em;
    margin-top: 0.75rem;
}

/* Final CTA - Cleaner gradient */
.final-cta {
    text-align: center;
    padding: 3rem;
    background: linear-gradient(135deg, #3B82F6 0%, #8B5CF6 100%);
    border-radius: 24px;
    margin-top: 2rem;
    margin-bottom: 2rem;
    box-shadow: 0 20px 40px -10px rgba(59, 130, 246, 0.3);
    position: relative;
    overflow: hidden;
}

.final-cta::before {
    content: '';
    position: absolute;
    top: -50%;
    right: -20%;
    width: 400px;
    height: 400px;
    background: radial-gradient(circle, rgba(255, 255, 255, 0.1) 0%, transparent 70%);
    pointer-events: none;
}

.final-cta h3 {
    font-size: 2rem;
    color: white;
    font-weight: 800;
    margin-bottom: 1rem;
    position: relative;
    z-index: 1;
}

.final-cta p {
    color: rgba(255, 255, 255, 0.9);
    font-size: 1.25rem;
    margin-bottom: 2rem;
    position: relative;
    z-index: 1;
}

.final-cta .btn-primary {
    background: white;
    color: #3B82F6;
    padding: 1.25rem 3rem;
    font-size: 1.125rem;
    font-weight: 700;
    border-radius: 12px;
    box-shadow: 0 8px 20px rgba(0, 0, 0, 0.15);
    position: relative;
    z-index: 1;
    transition: all 0.3s ease;
}

.final-cta .btn-primary:hover {
    transform: translateY(-2px);
    box-shadow: 0 12px 28px rgba(0, 0, 0, 0.2);
}

/* Responsive adjustments */
@media (max-width: 768px) {
    .dashboard-container {
        padding: 0;
    }
    
    .welcome-title {
        font-size: 1.875rem;
    }
    
    .welcome-subtitle {
        font-size: 1rem;
    }
    
    .guest-hero {
        padding: 2rem 1.5rem;
    }
    
    .guest-hero h1 {
        font-size: 2.25rem;
    }
    
    .guest-hero p {
        font-size: 1.125rem;
    }
    
    .platform-section {
        padding: 1.25rem;
        margin-bottom: 2rem;
        border-radius: 12px;
    }
    
    .features-grid {
        grid-template-columns: 1fr;
        gap: 1rem;
    }
    
    .credits-container {
        flex-direction: column;
        text-align: center;
    }
    
    .credits-info {
        flex-direction: column;
    }
    
    .credits-number {
        font-size: 1.75rem;
    }
    
    .benefit-card {
        padding: 1.5rem 1.25rem;
    }
}

/* Loading animation */
.skeleton-text {
    display: inline-block;
    background: linear-gradient(90deg, #E2E8F0 25%, #F1F5F9 50%, #E2E8F0 75%);
    background-size: 200% 100%;
    animation: loading 1.5s infinite;
    border-radius: 6px;
    height: 1rem;
    width: 100px;
}

@keyframes loading {
    0% { background-position: 200% 0; }
    100% { background-position: -200% 0; }
}

/* Smooth animations */
* {
    transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);
}
</style>
{% endblock %}

{% block content %}
<div class="dashboard-wrapper">
    <div class="dashboard-container">
        <div class="dashboard-header">
        {% if g.user and not g.user.get('is_guest') %}
        <!-- Logged in user dashboard -->
        <div class="welcome-section">
            <h1 class="welcome-title">Welcome back, <span id="username-display">{{ g.user.get('data', {}).get('username', 'Creator') }}</span></h1>
            <p class="welcome-subtitle">Ready to create amazing content today?</p>
        </div>
        
        <!-- Credits Section -->
        <div class="credits-section">
            <div class="credits-container">
                <a href="{{ url_for('credits_history.index') }}" class="credits-info" style="text-decoration: none; color: inherit; cursor: pointer;">
                    <div class="credits-avatar">
                        <span id="user-avatar">{{ g.user.get('data', {}).get('username', 'U')[0].upper() }}</span>
                    </div>
                    <div class="credits-details">
                        <h3>AI Credits</h3>
                        <div class="credits-amount">
                            <span class="credits-number" id="credits-display">
                                <span class="skeleton-text" style="width: 80px; height: 2.5rem;"></span>
                            </span>
                            <span class="credits-label">credits remaining</span>
                        </div>
                        <div style="font-size: 0.75rem; color: rgba(255, 255, 255, 0.8); margin-top: 0.25rem;">
                            <i class="ph ph-clock-counter-clockwise"></i> View history
                        </div>
                    </div>
                </a>
                <a href="{{ url_for('payment.index') }}" class="credits-action">
                    <i class="ph ph-sparkle"></i>
                    Get More Credits
                </a>
            </div>
        </div>
        
        {% else %}
        <!-- Guest user hero section -->
        <div class="guest-hero">
            <h1>Create Content That <span class="gradient-text">Gets Results</span></h1>
            <p>AI-powered tools to help you create viral thumbnails, engaging titles, and optimize your content across YouTube and X</p>
            <div class="guest-cta-buttons">
                <a href="/auth/register" class="btn-primary">
                    <i class="ph ph-rocket-launch"></i>
                    Start Creating Free
                </a>
                <a href="/auth/login" class="btn-secondary">
                    <i class="ph ph-sign-in"></i>
                    Sign In
                </a>
            </div>
        </div>
        {% endif %}
    </div>

    <!-- YouTube Tools Section -->
    {% set has_youtube_permissions = not workspace_info or workspace_info.is_owner or
       workspace_info.permissions.video_script or
       workspace_info.permissions.video_title or
       workspace_info.permissions.video_tags or
       workspace_info.permissions.video_description or
       workspace_info.permissions.thumbnail or
       workspace_info.permissions.analytics or
       workspace_info.permissions.competitors %}

    {% if has_youtube_permissions %}
    <div class="platform-section">
        <div class="platform-header">
            <i class="ph ph-youtube-logo"></i>
            <h2>YouTube Tools</h2>
        </div>

        <div class="features-grid">
            <!-- Video Script -->
            {% if not workspace_info or workspace_info.is_owner or workspace_info.permissions.video_script %}
            <a href="{{ url_for('video_script.video_script') }}" class="feature-card" onclick="return BaseApp.checkGuestAccess(event, this)">
                <div class="feature-content">
                    <h3><i class="ph ph-file-doc feature-icon-inline"></i>Scripts</h3>
                    <p>Write and manage video scripts</p>
                </div>
            </a>
            {% endif %}

            <!-- Video Title -->
            {% if not workspace_info or workspace_info.is_owner or workspace_info.permissions.video_title %}
            <a href="{{ url_for('video_title.video_title') }}" class="feature-card" onclick="return BaseApp.checkGuestAccess(event, this)">
                <div class="feature-content">
                    <h3><i class="ph ph-text-t feature-icon-inline"></i>Titles</h3>
                    <p>Generate viral video titles</p>
                </div>
            </a>
            {% endif %}

            <!-- Video Tags -->
            {% if not workspace_info or workspace_info.is_owner or workspace_info.permissions.video_tags %}
            <a href="{{ url_for('video_tags.video_tags') }}" class="feature-card" onclick="return BaseApp.checkGuestAccess(event, this)">
                <div class="feature-content">
                    <h3><i class="ph ph-hash feature-icon-inline"></i>Tags</h3>
                    <p>Find trending tags for reach</p>
                </div>
            </a>
            {% endif %}

            <!-- Video Description -->
            {% if not workspace_info or workspace_info.is_owner or workspace_info.permissions.video_description %}
            <a href="{{ url_for('video_description.video_description') }}" class="feature-card" onclick="return BaseApp.checkGuestAccess(event, this)">
                <div class="feature-content">
                    <h3><i class="ph ph-file-text feature-icon-inline"></i>Descriptions</h3>
                    <p>Write SEO-optimized descriptions</p>
                </div>
            </a>
            {% endif %}

            <!-- Thumbnail -->
            {% if not workspace_info or workspace_info.is_owner or workspace_info.permissions.thumbnail %}
            <a href="{{ url_for('thumbnail.index') }}" class="feature-card" onclick="return BaseApp.checkGuestAccess(event, this)">
                <div class="feature-content">
                    <h3><i class="ph ph-image feature-icon-inline"></i>Thumbnails</h3>
                    <p>Design thumbnails that get clicks</p>
                </div>
            </a>
            {% endif %}

            <!-- Analytics -->
            {% if not workspace_info or workspace_info.is_owner or workspace_info.permissions.analytics %}
            <a href="{{ url_for('analytics.index', platform='youtube') }}" class="feature-card" onclick="return BaseApp.checkGuestAccess(event, this)">
                <div class="feature-content">
                    <h3><i class="ph ph-chart-line feature-icon-inline"></i>Analytics</h3>
                    <p>Track performance metrics</p>
                </div>
            </a>
            {% endif %}
            <!-- Competitors -->
            {% if not workspace_info or workspace_info.is_owner or workspace_info.permissions.competitors %}
            <a href="{{ url_for('competitors.competitors') }}" class="feature-card" onclick="return BaseApp.checkGuestAccess(event, this)">
                <div class="feature-content">
                    <h3><i class="ph ph-users-three feature-icon-inline"></i>Competitors</h3>
                    <p>Analyze competitor strategies</p>
                </div>
            </a>
            {% endif %}
        </div>
    </div>
    {% endif %}

    <!-- X Tools Section -->
    {% set has_x_permissions = not workspace_info or workspace_info.is_owner or
       workspace_info.permissions.x_post_editor or
       workspace_info.permissions.analytics or
       workspace_info.permissions.reply_guy or
       workspace_info.permissions.clip_spaces or
       workspace_info.permissions.niche %}

    {% if has_x_permissions %}
    <div class="platform-section">
        <div class="platform-header">
            <i class="ph ph-x-logo"></i>
            <h2>X Tools</h2>
        </div>

        <div class="features-grid">
            <!-- X Post Editor -->
            {% if not workspace_info or workspace_info.is_owner or workspace_info.permissions.x_post_editor %}
            <a href="{{ url_for('x_post_editor.x_post_editor') }}" class="feature-card" onclick="return BaseApp.checkGuestAccess(event, this)">
                <div class="feature-content">
                    <h3><i class="ph ph-pencil-simple feature-icon-inline"></i>Post Editor</h3>
                    <p>Create posts and threads</p>
                </div>
            </a>
            {% endif %}
            
            <!-- X Analytics -->
            {% if not workspace_info or workspace_info.is_owner or workspace_info.permissions.analytics %}
            <a href="{{ url_for('analytics.index', platform='x') }}" class="feature-card" onclick="return BaseApp.checkGuestAccess(event, this)">
                <div class="feature-content">
                    <h3><i class="ph ph-chart-bar feature-icon-inline"></i>Analytics</h3>
                    <p>Monitor growth metrics</p>
                </div>
            </a>
            {% endif %}

            <!-- Reply Guy -->
            {% if not workspace_info or workspace_info.is_owner or workspace_info.permissions.reply_guy %}
            <a href="{{ url_for('reply_guy.index') }}" class="feature-card" onclick="return BaseApp.checkGuestAccess(event, this)">
                <div class="feature-content">
                    <h3><i class="ph ph-chat-circle-text feature-icon-inline"></i>Reply Guy</h3>
                    <p>Create engaging replies</p>
                </div>
            </a>
            {% endif %}

            <!-- Clip Spaces -->
            {% if not workspace_info or workspace_info.is_owner or workspace_info.permissions.clip_spaces %}
            <a href="{{ url_for('clip_spaces.index') }}" class="feature-card" onclick="return BaseApp.checkGuestAccess(event, this)">
                <div class="feature-content">
                    <h3><i class="ph ph-scissors feature-icon-inline"></i>Clip Spaces</h3>
                    <p>Clip hot moments from Spaces</p>
                </div>
            </a>
            {% endif %}

            <!-- Niche -->
            {% if not workspace_info or workspace_info.is_owner or workspace_info.permissions.niche %}
            <a href="{{ url_for('niche.index') }}" class="feature-card" onclick="return BaseApp.checkGuestAccess(event, this)">
                <div class="feature-content">
                    <h3><i class="ph ph-compass feature-icon-inline"></i>Niche</h3>
                    <p>Discover what's hot on timeline</p>
                </div>
            </a>
            {% endif %}
        </div>
    </div>
    {% endif %}

    <!-- Content Management Section -->
    {% set has_content_permissions = not workspace_info or workspace_info.is_owner or
       workspace_info.permissions.brain_dump or
       workspace_info.permissions.mind_map or
       workspace_info.permissions.content_wiki or
       workspace_info.permissions.content_calendar %}

    {% if has_content_permissions %}
    <div class="platform-section">
        <div class="platform-header">
            <i class="ph ph-folder"></i>
            <h2>Content Management</h2>
        </div>

        <div class="features-grid">
            <!-- Brain Dump -->
            {% if not workspace_info or workspace_info.is_owner or workspace_info.permissions.brain_dump %}
            <a href="{{ url_for('brain_dump.brain_dump') }}" class="feature-card" onclick="return BaseApp.checkGuestAccess(event, this)">
                <div class="feature-content">
                    <h3><i class="ph ph-brain feature-icon-inline"></i>Brain Dump</h3>
                    <p>Capture and organize ideas</p>
                </div>
            </a>
            {% endif %}

            <!-- Mind Map -->
            {% if not workspace_info or workspace_info.is_owner or workspace_info.permissions.mind_map %}
            <a href="{{ url_for('mind_map.mind_map') }}" class="feature-card" onclick="return BaseApp.checkGuestAccess(event, this)">
                <div class="feature-content">
                    <h3><i class="ph ph-graph feature-icon-inline"></i>Mind Map</h3>
                    <p>Visual brainstorming & connections</p>
                </div>
            </a>
            {% endif %}

            <!-- Content Wiki -->
            {% if not workspace_info or workspace_info.is_owner or workspace_info.permissions.content_wiki %}
            <a href="{{ url_for('content_wiki.content_wiki') }}" class="feature-card" onclick="return BaseApp.checkGuestAccess(event, this)">
                <div class="feature-content">
                    <h3><i class="ph ph-books feature-icon-inline"></i>Content Wiki</h3>
                    <p>Build your knowledge base</p>
                </div>
            </a>
            {% endif %}

            <!-- Content Calendar -->
            {% if not workspace_info or workspace_info.is_owner or workspace_info.permissions.content_calendar %}
            <a href="{{ url_for('content_calendar.content_calendar') }}" class="feature-card" onclick="return BaseApp.checkGuestAccess(event, this)">
                <div class="feature-content">
                    <h3><i class="ph ph-calendar feature-icon-inline"></i>Content Calendar</h3>
                    <p>Plan and schedule content</p>
                </div>
            </a>
            {% endif %}

        </div>
    </div>
    {% endif %}

    <!-- Settings Section - Always show since Teams is always visible -->
    <div class="platform-section">
        <div class="platform-header">
            <i class="ph ph-gear"></i>
            <h2>Settings</h2>
        </div>

        <div class="features-grid">
            <!-- Social Accounts -->
            {% if not workspace_info or workspace_info.is_owner %}
            <a href="{{ url_for('accounts.index') }}" class="feature-card" onclick="return BaseApp.checkGuestAccess(event, this)">
                <div class="feature-content">
                    <h3><i class="ph ph-user-gear feature-icon-inline"></i>Social Accounts</h3>
                    <p>Connect your social platforms</p>
                </div>
            </a>
            {% endif %}

            <!-- Subscription -->
            {% if not workspace_info or workspace_info.is_owner %}
            <a href="{{ url_for('payment.index') }}" class="feature-card" onclick="return BaseApp.checkGuestAccess(event, this)">
                <div class="feature-content">
                    <h3><i class="ph ph-crown feature-icon-inline"></i>Subscription</h3>
                    <p>Manage your plan & billing</p>
                </div>
            </a>
            {% endif %}

            <!-- Teams - Always visible for workspace switching -->
            <a href="/teams" class="feature-card">
                <div class="feature-content">
                    <h3><i class="ph ph-users-three feature-icon-inline"></i>Teams</h3>
                    <p>{% if workspace_info and not workspace_info.is_owner %}Switch workspaces{% else %}Collaborate with your team{% endif %}</p>
                </div>
            </a>
        </div>
    </div>

    <!-- Coming Soon Section -->
    <div class="platform-section coming-soon-section">
        <div class="platform-header">
            <i class="ph ph-sparkle" style="color: #94A3B8;"></i>
            <h2>Coming Soon</h2>
        </div>

        <div class="features-grid">
            <!-- TikTok -->
            <div class="feature-card coming-soon-card">
                <div class="feature-content">
                    <h3><i class="ph ph-tiktok-logo feature-icon-inline"></i>TikTok Tools</h3>
                    <p>Trending sounds and viral hashtags</p>
                    <span class="coming-soon-badge">Coming Soon</span>
                </div>
            </div>
            
            <!-- Instagram -->
            <div class="feature-card coming-soon-card">
                <div class="feature-content">
                    <h3><i class="ph ph-instagram-logo feature-icon-inline"></i>Instagram Suite</h3>
                    <p>Reels, Stories, and feed optimization</p>
                    <span class="coming-soon-badge">Coming Soon</span>
                </div>
            </div>
        </div>
    </div>

    {% if not g.user or g.user.get('is_guest') %}
    <!-- Final CTA -->
    <div class="final-cta">
        <h3>Ready to Transform Your Content?</h3>
        <p>Join thousands of creators who are growing faster with Creatrics</p>
        <a href="/auth/register" class="btn-primary">
            <i class="ph ph-rocket-launch"></i>
            Start Creating for Free
        </a>
    </div>
    {% endif %}
    </div>
</div>

<script>
// Load user credits when logged in
document.addEventListener('DOMContentLoaded', function() {
    {% if g.user and not g.user.get('is_guest') %}
    // Fetch dashboard stats
    fetch('/api/dashboard-stats')
        .then(response => response.json())
        .then(data => {
            // Update credits display with animation
            const creditsDisplay = document.getElementById('credits-display');
            if (creditsDisplay && data.credits !== undefined) {
                creditsDisplay.style.opacity = '0';
                creditsDisplay.textContent = data.credits.toLocaleString();
                setTimeout(() => {
                    creditsDisplay.style.transition = 'opacity 0.5s ease';
                    creditsDisplay.style.opacity = '1';
                }, 100);
            }
            
            // Update username if needed
            const usernameDisplay = document.getElementById('username-display');
            if (usernameDisplay && data.username) {
                usernameDisplay.textContent = data.username;
            }
            
            // Update avatar
            const avatarDisplay = document.getElementById('user-avatar');
            if (avatarDisplay && data.username) {
                avatarDisplay.textContent = data.username[0].toUpperCase();
            }
        })
        .catch(error => {
            console.error('Error loading dashboard stats:', error);
            // Remove skeleton loader even on error
            const creditsDisplay = document.getElementById('credits-display');
            if (creditsDisplay) {
                creditsDisplay.textContent = '0';
            }
        });
    {% endif %}
});
</script>
{% endblock %}