{% extends "base.html" %}
{% set check_auth = true %}

{% block title %}AI Content Calendar - Plan & Schedule Your Content Strategy | Creatrics{% endblock %}

{% block seo_meta %}
<meta name="description" content="Plan and schedule your content strategy with AI-powered content calendar. Organize YouTube videos, social media posts, and track publishing schedules with Creatrics intelligent planning tool.">
<meta name="keywords" content="AI content calendar, content planning, social media scheduler, YouTube planning, content strategy, editorial calendar">
{% endblock %}

{% block additional_styles %}
<!-- Include FullCalendar CSS first -->
<link href='https://cdn.jsdelivr.net/npm/fullcalendar@5.11.3/main.min.css' rel='stylesheet' />
<link rel="stylesheet" href="{{ url_for('static', filename='css/content_calendar.css') }}">
<link rel="stylesheet" href="{{ url_for('static', filename='css/content-event-modal.css') }}">
{% endblock %}

{% block content %}
<div class="calendar-wrapper">
    <!-- Header -->
    <div class="calendar-header">
        <h1 class="calendar-title">
            <i class="ph ph-calendar"></i>
            Content Calendar
        </h1>
        <div class="week-start-toggle">
            <button class="week-toggle-btn active" onclick="setWeekStart(1)">
                Start: Mon
            </button>
            <button class="week-toggle-btn" onclick="setWeekStart(0)">
                Start: Sun
            </button>
        </div>
    </div>
    
    <!-- Controls -->
    <div class="calendar-controls">
        <div class="control-group">
            <button class="btn-add-content" onclick="openNewEventModal('organic')">
                <i class="ph ph-plus-circle"></i>
                Add Content
            </button>
        </div>

        <div class="view-toggle">
            <button class="view-btn active" onclick="switchView('calendar')">
                <i class="ph ph-calendar"></i>
                Calendar
            </button>
            <button class="view-btn" onclick="switchView('table')">
                <i class="ph ph-table"></i>
                Table
            </button>
            <button class="view-btn" onclick="switchView('kanban')">
                <i class="ph ph-kanban"></i>
                Kanban
            </button>
            <button class="view-btn" onclick="toggleAnalytics()" id="analytics-toggle-btn">
                <i class="ph ph-chart-line"></i>
                Analytics
            </button>
        </div>
        
        <div class="control-group">
            <button class="btn btn-icon" onclick="previousMonth()">
                <i class="ph ph-caret-left"></i>
            </button>
            <span id="current-month" style="min-width: 150px; text-align: center; font-weight: 600; color: var(--text-primary);">
                Loading...
            </span>
            <button class="btn btn-icon" onclick="nextMonth()">
                <i class="ph ph-caret-right"></i>
            </button>
        </div>
    </div>
    
    <!-- Main Content Area -->
    <div class="main-content-area">
        <!-- Calendar View -->
        <div id="calendar"></div>

        <!-- Table View -->
        <div class="main-panel" id="table-view">
            <table class="content-table">
                <thead>
                    <tr>
                        <th>Title</th>
                        <th>Date</th>
                        <th>Platform</th>
                        <th>Type</th>
                        <th>Status</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody id="table-body">
                    <!-- Will be populated by JavaScript -->
                </tbody>
            </table>
        </div>

        <!-- Kanban View -->
        <div class="main-panel" id="kanban-view">
            <div class="kanban-board">
                <div class="kanban-column" data-status="draft">
                    <div class="kanban-column-header">
                        <div class="kanban-column-title">
                            <i class="ph ph-pencil"></i>
                            Draft
                        </div>
                        <span class="kanban-column-count">0</span>
                    </div>
                    <div class="kanban-column-body" ondrop="dropCard(event)" ondragover="allowDrop(event)">
                        <!-- Cards will be populated here -->
                    </div>
                </div>

                <div class="kanban-column" data-status="in-progress">
                    <div class="kanban-column-header">
                        <div class="kanban-column-title">
                            <i class="ph ph-clock"></i>
                            In Progress
                        </div>
                        <span class="kanban-column-count">0</span>
                    </div>
                    <div class="kanban-column-body" ondrop="dropCard(event)" ondragover="allowDrop(event)">
                        <!-- Cards will be populated here -->
                    </div>
                </div>

                <div class="kanban-column" data-status="review">
                    <div class="kanban-column-header">
                        <div class="kanban-column-title">
                            <i class="ph ph-eye"></i>
                            Review
                        </div>
                        <span class="kanban-column-count">0</span>
                    </div>
                    <div class="kanban-column-body" ondrop="dropCard(event)" ondragover="allowDrop(event)">
                        <!-- Cards will be populated here -->
                    </div>
                </div>

                <div class="kanban-column" data-status="ready">
                    <div class="kanban-column-header">
                        <div class="kanban-column-title">
                            <i class="ph ph-check-circle"></i>
                            Ready
                        </div>
                        <span class="kanban-column-count">0</span>
                    </div>
                    <div class="kanban-column-body" ondrop="dropCard(event)" ondragover="allowDrop(event)">
                        <!-- Cards will be populated here -->
                    </div>
                </div>
            </div>
        </div>

        <!-- Analytics Panel -->
        <div class="main-panel" id="analytics-panel">
        <!-- Content Type Section -->
        <div class="analytics-section">
            <h3><i class="ph ph-tag"></i> Content Type</h3>
            <div class="analytics-grid">
                <div class="analytics-card">
                    <div class="analytics-label">Total Posts</div>
                    <div class="analytics-value" id="total-posts">0</div>
                </div>
                <div class="analytics-card">
                    <div class="analytics-label">Organic Content</div>
                    <div class="analytics-value" id="organic-posts">0</div>
                </div>
                <div class="analytics-card">
                    <div class="analytics-label">Sponsored Content</div>
                    <div class="analytics-value" id="sponsored-posts">0</div>
                </div>
            </div>
        </div>

        <!-- Status Section -->
        <div class="analytics-section">
            <h3><i class="ph ph-list-checks"></i> Content Status</h3>
            <div class="analytics-grid">
                <div class="analytics-card">
                    <div class="analytics-label">Draft</div>
                    <div class="analytics-value" id="draft-posts">0</div>
                </div>
                <div class="analytics-card">
                    <div class="analytics-label">In Progress</div>
                    <div class="analytics-value" id="progress-posts">0</div>
                </div>
                <div class="analytics-card">
                    <div class="analytics-label">Review</div>
                    <div class="analytics-value" id="review-posts">0</div>
                </div>
                <div class="analytics-card">
                    <div class="analytics-label">Ready</div>
                    <div class="analytics-value" id="ready-posts">0</div>
                </div>
            </div>
        </div>

        <!-- Daily Posts Chart -->
        <div class="chart-container">
            <h3><i class="ph ph-chart-bar"></i> Posts Per Day</h3>
            <div class="chart-wrapper">
                <div class="chart-y-axis" id="chart-y-axis">
                    <!-- Y-axis labels will be generated dynamically -->
                </div>
                <div class="chart-bars" id="chart-bars">
                    <!-- Bars will be generated dynamically -->
                </div>
                <div class="chart-x-axis" id="chart-x-axis">
                    <!-- X-axis labels will be generated dynamically -->
                </div>
            </div>
        </div>
        </div>
    </div>
</div>

<!-- Old modal removed - using content-event-modal.js instead -->
{% endblock %}

{% block scripts %}
<!-- Include FullCalendar JS -->
<script src='https://cdn.jsdelivr.net/npm/fullcalendar@5.11.3/main.min.js'></script>
<script src='https://cdn.jsdelivr.net/npm/@fullcalendar/interaction@5.11.3/main.min.js'></script>
<script src="{{ url_for('static', filename='scripts/content-event-modal.js') }}"></script>
<script src="{{ url_for('static', filename='scripts/content_calendar.js') }}"></script>
{% endblock %}