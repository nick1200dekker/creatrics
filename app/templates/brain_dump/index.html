{% extends "base.html" %}

{% block title %}AI Brain Dump - Capture & Organize Creative Ideas | Creatrics{% endblock %}

{% block seo_meta %}
<meta name="description" content="Capture and organize your creative ideas with AI-powered brain dump tool. Store content ideas, brainstorm concepts, and never lose inspiration with Creatrics intelligent note-taking system.">
<meta name="keywords" content="AI brain dump, creative ideas organizer, content brainstorming, idea management, creative notes, content planning">
{% endblock %}

{% block additional_styles %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/brain_dump.css') }}">
{% endblock %}

{% block content %}
<div class="content-panel">
    <div class="brain-dump-wrapper">
    <!-- Left Sidebar -->
    <aside class="notes-sidebar">
        <div class="sidebar-header">
            <h2 class="sidebar-title">
                <i class="ph ph-brain"></i>
                Brain Dump
            </h2>
            <button class="new-note-btn" onclick="createNewNote()">
                <i class="ph ph-plus"></i>
                New Note
            </button>
        </div>

        <div class="search-box">
            <div class="search-wrapper">
                <input type="text" 
                       class="search-input" 
                       id="searchInput" 
                       placeholder="Search notes...">
                <i class="ph ph-magnifying-glass search-icon"></i>
            </div>
        </div>
        
        <div class="notes-list" id="notesList">
            <div class="loading">
                <div class="loading-spinner">
                    <i class="ph ph-spinner"></i>
                </div>
                <div>Loading notes...</div>
            </div>
        </div>
    </aside>
    
    <!-- Right Side - Empty State (hidden by default) -->
    <main class="empty-state-full" id="emptyStateContainer" style="display: none;">
        <i class="ph ph-brain empty-state-icon"></i>
        <h2 class="empty-state-title">Welcome to Brain Dump</h2>
        <p class="empty-state-text">Create or select a note to start capturing your thoughts and ideas</p>
        <button class="action-btn" id="emptyStateButton" onclick="createNewNote()">
            <i class="ph ph-plus"></i>
            <span id="emptyStateButtonText">Create Your First Note</span>
        </button>
    </main>

    <!-- Right Editor Area (shown by default) -->
    <main class="editor-area" id="editorArea" style="display: flex;">
        <!-- Editor -->
        <div id="noteEditor" style="height: 100%; display: flex; flex-direction: column;">
            <div class="editor-header">
                <div class="editor-title-wrapper">
                    <input type="text"
                           class="editor-title-input"
                           id="noteTitle"
                           placeholder="Untitled Note"
                           autocomplete="off">
                    <div class="title-actions" style="position: relative;">
                        <button class="icon-btn" id="tagsMenuBtn" onclick="toggleTagsMenu()" title="Manage Tags">
                            <i class="ph ph-tag"></i>
                        </button>
                        <button class="icon-btn" id="shareBtn" onclick="toggleShare()" title="Share Note">
                            <i class="ph ph-share-network"></i>
                        </button>

                        <!-- Tags Dropdown Menu -->
                        <div class="tags-dropdown" id="tagsDropdown" style="display: none;">
                <div class="tags-dropdown-header">
                    <span>Manage Tags</span>
                    <button class="icon-btn-small" onclick="toggleTagsMenu()">
                        <i class="ph ph-x"></i>
                    </button>
                </div>
                <div class="tags-container" id="tagsContainer">
                    <!-- Preset tags -->
                    <button class="tag-preset" data-tag="video-idea" onclick="toggleTag('video-idea')">
                        üé• Video Idea
                    </button>
                    <button class="tag-preset" data-tag="content-idea" onclick="toggleTag('content-idea')">
                        üí° Content Idea
                    </button>
                    <button class="tag-preset" data-tag="draft" onclick="toggleTag('draft')">
                        üìù Draft
                    </button>
                    <button class="tag-preset" data-tag="important" onclick="toggleTag('important')">
                        ‚≠ê Important
                    </button>
                    <button class="tag-preset" data-tag="research" onclick="toggleTag('research')">
                        üîç Research
                    </button>
                    <button class="tag-preset" data-tag="script" onclick="toggleTag('script')">
                        üìú Script
                    </button>
                    <button class="tag-preset" data-tag="social-media" onclick="toggleTag('social-media')">
                        üì± Social Media
                    </button>
                    <button class="tag-preset" data-tag="tutorial" onclick="toggleTag('tutorial')">
                        üìö Tutorial
                    </button>
                    <!-- Add custom tag button -->
                    <button class="tag-add" onclick="addCustomTag()">
                        <i class="ph ph-plus"></i> Add Tag
                    </button>
                </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="editor-toolbar">
                <div class="toolbar-group">
                    <button class="toolbar-btn" onclick="formatText('bold')" title="Bold (Ctrl+B)">
                        <i class="ph ph-text-b"></i>
                    </button>
                    <button class="toolbar-btn" onclick="formatText('italic')" title="Italic (Ctrl+I)">
                        <i class="ph ph-text-italic"></i>
                    </button>
                    <button class="toolbar-btn" onclick="formatText('underline')" title="Underline (Ctrl+U)">
                        <i class="ph ph-text-underline"></i>
                    </button>
                </div>
                
                <div class="toolbar-separator"></div>
                
                <div class="toolbar-group">
                    <button class="toolbar-btn" onclick="formatText('formatBlock', 'h1')" title="Heading 1">
                        H1
                    </button>
                    <button class="toolbar-btn" onclick="formatText('formatBlock', 'h2')" title="Heading 2">
                        H2
                    </button>
                    <button class="toolbar-btn" onclick="formatText('formatBlock', 'h3')" title="Heading 3">
                        H3
                    </button>
                    <button class="toolbar-btn" onclick="formatText('formatBlock', 'p')" title="Paragraph">
                        P
                    </button>
                </div>
                
                <div class="toolbar-separator"></div>
                
                <div class="toolbar-group">
                    <button class="toolbar-btn" onclick="formatText('insertUnorderedList')" title="Bullet List">
                        <i class="ph ph-list-bullets"></i>
                    </button>
                    <button class="toolbar-btn" onclick="formatText('insertOrderedList')" title="Numbered List">
                        <i class="ph ph-list-numbers"></i>
                    </button>
                </div>
                
                <div class="toolbar-separator"></div>
                
                <div class="toolbar-group">
                    <button class="toolbar-btn" onclick="formatText('formatBlock', 'blockquote')" title="Quote">
                        <i class="ph ph-quotes"></i>
                    </button>
                    <button class="toolbar-btn" onclick="insertCode()" title="Code">
                        <i class="ph ph-code"></i>
                    </button>
                    <button class="toolbar-btn" onclick="insertLink()" title="Link (Ctrl+K)">
                        <i class="ph ph-link"></i>
                    </button>
                </div>
                
                <div class="toolbar-separator"></div>
                
                <div class="toolbar-group">
                    <div class="color-picker-wrapper">
                        <input type="color" id="colorPicker" onchange="changeTextColor(this.value)">
                        <button class="toolbar-btn" onclick="document.getElementById('colorPicker').click()" title="Text Color">
                            <i class="ph ph-palette"></i>
                        </button>
                    </div>
                </div>
                
                <div class="toolbar-separator"></div>
                
                <!-- AI Assistant in Toolbar -->
                <div class="ai-toolbar-section">
                    <button class="ai-toggle-btn" onclick="toggleAIAgent()" title="AI Assistant">
                        <i class="ph ph-robot"></i>
                        AI Assistant
                        <i class="ph ph-caret-down ai-caret"></i>
                    </button>
                </div>
            </div>
            
            <!-- AI Agent Panel (below toolbar) -->
            <div class="ai-agent-panel collapsed" id="aiAgentPanel">
                <div class="ai-agent-content">
                    <div class="ai-prompt-group">
                        <input type="text"
                               id="aiModifyInput"
                               class="ai-modify-input"
                               placeholder="e.g., 'summarize this', 'fix grammar', 'make it more professional', 'extract key points'"
                               onkeypress="if(event.key === 'Enter') modifyNoteWithAI()"/>
                        <button class="ai-modify-btn" onclick="modifyNoteWithAI()" id="aiModifyBtn">
                            <i class="ph ph-magic-wand"></i>
                            <span>Apply</span>
                        </button>
                    </div>
                    <div class="ai-suggestions">
                        <span class="suggestion-label">Quick actions:</span>
                        <button class="suggestion-chip" onclick="setAIPrompt('Summarize the main points')">
                            <i class="ph ph-list-bullets"></i> Summarize
                        </button>
                        <button class="suggestion-chip" onclick="setAIPrompt('Fix grammar and spelling')">
                            <i class="ph ph-text-aa"></i> Fix Grammar
                        </button>
                        <button class="suggestion-chip" onclick="setAIPrompt('Make it more professional')">
                            <i class="ph ph-briefcase"></i> Professional
                        </button>
                        <button class="suggestion-chip" onclick="setAIPrompt('Extract action items')">
                            <i class="ph ph-check-square"></i> Action Items
                        </button>
                        <button class="suggestion-chip" onclick="setAIPrompt('Organize into sections')">
                            <i class="ph ph-folders"></i> Organize
                        </button>
                    </div>
                </div>
            </div>
            
            <div class="editor-content">
                <div id="editor" contenteditable="true"></div>
            </div>
            
            <div class="editor-footer">
                <div class="save-status saved" id="saveStatus">
                    <i class="ph ph-check-circle"></i>
                    <span>Saved</span>
                </div>
            </div>
        </div>
    </main>
    </div>
</div>

<!-- Custom Tag Modal -->
<div class="custom-tag-modal" id="customTagModal">
    <div class="custom-tag-modal-content">
        <div class="custom-tag-modal-header">
            <h3 class="custom-tag-modal-title">
                <i class="ph ph-tag"></i>
                Add Custom Tag
            </h3>
        </div>
        
        <div class="custom-tag-modal-body">
            <div class="tag-field">
                <label class="tag-label">Tag Name</label>
                <input type="text" 
                       id="customTagNameInput" 
                       class="tag-input" 
                       placeholder="Enter tag name (e.g., 'project-ideas')"
                       autocomplete="off"
                       maxlength="30">
            </div>
            
            <div class="tag-field">
                <label class="tag-label">Emoji (Optional)</label>
                <div class="emoji-input-group">
                    <input type="text" 
                           id="customTagEmojiInput" 
                           class="tag-input emoji-input" 
                           placeholder="üè∑Ô∏è"
                           maxlength="2"
                           autocomplete="off">
                    <div class="emoji-suggestions">
                        <button type="button" class="emoji-btn" onclick="setTagEmoji('üè∑Ô∏è')">üè∑Ô∏è</button>
                        <button type="button" class="emoji-btn" onclick="setTagEmoji('üìå')">üìå</button>
                        <button type="button" class="emoji-btn" onclick="setTagEmoji('‚≠ê')">‚≠ê</button>
                        <button type="button" class="emoji-btn" onclick="setTagEmoji('üéØ')">üéØ</button>
                        <button type="button" class="emoji-btn" onclick="setTagEmoji('üí°')">üí°</button>
                        <button type="button" class="emoji-btn" onclick="setTagEmoji('üöÄ')">üöÄ</button>
                        <button type="button" class="emoji-btn" onclick="setTagEmoji('üìù')">üìù</button>
                        <button type="button" class="emoji-btn" onclick="setTagEmoji('üî•')">üî•</button>
                    </div>
                </div>
            </div>
            
            <div class="tag-preview">
                <label class="tag-label">Preview</label>
                <div class="tag-preview-display" id="tagPreview">
                    <span class="tag-preview-chip">
                        <span id="previewEmoji">üè∑Ô∏è</span>
                        <span id="previewText">custom-tag</span>
                    </span>
                </div>
            </div>
        </div>
        
        <div class="custom-tag-modal-actions">
            <button class="custom-tag-modal-btn cancel" onclick="closeCustomTagModal()">Cancel</button>
            <button class="custom-tag-modal-btn primary" onclick="createCustomTagFromModal()" id="createTagBtn">
                <i class="ph ph-plus"></i>
                Add Tag
            </button>
        </div>
    </div>
</div>

<!-- Link Modal -->
<div class="link-modal" id="linkModal">
    <div class="link-modal-content">
        <div class="link-modal-header">
            <h3 class="link-modal-title">
                <i class="ph ph-link"></i>
                Add Link
            </h3>
        </div>
        
        <div class="link-modal-body">
            <div class="link-field">
                <label class="link-label">Link Text</label>
                <input type="text" 
                       id="linkTextInput" 
                       class="link-input" 
                       placeholder="Enter the text to display"
                       autocomplete="off">
            </div>
            
            <div class="link-field">
                <label class="link-label">URL</label>
                <input type="url" 
                       id="linkUrlInput" 
                       class="link-input" 
                       placeholder="https://example.com"
                       autocomplete="off">
            </div>
            
            <div class="link-options">
                <label class="link-checkbox">
                    <input type="checkbox" id="linkTargetBlank" checked>
                    <span class="checkmark"></span>
                    Open in new tab
                </label>
            </div>
        </div>
        
        <div class="link-modal-actions">
            <button class="link-modal-btn cancel" onclick="closeLinkModal()">Cancel</button>
            <button class="link-modal-btn primary" onclick="insertLinkFromModal()" id="insertLinkBtn">
                <i class="ph ph-link"></i>
                Insert Link
            </button>
        </div>
    </div>
</div>

<!-- Share Modal -->
<div class="share-modal" id="shareModal">
    <div class="share-modal-content">
        <div class="share-modal-header">
            <h3 class="share-modal-title">
                <i class="ph ph-share-network"></i>
                Share Note
            </h3>
        </div>

        <div class="share-permission-container" id="sharePermissionContainer">
            <div class="share-permission-label">Share Permission</div>
            <div class="permission-options">
                <label class="permission-option">
                    <input type="radio" name="sharePermission" value="view" checked>
                    <span class="permission-option-content">
                        <i class="ph ph-eye"></i>
                        <div>
                            <div class="permission-title">View Only</div>
                            <div class="permission-desc">Others can only read the note</div>
                        </div>
                    </span>
                </label>
                <label class="permission-option">
                    <input type="radio" name="sharePermission" value="edit">
                    <span class="permission-option-content">
                        <i class="ph ph-pencil"></i>
                        <div>
                            <div class="permission-title">Can Edit</div>
                            <div class="permission-desc">Others can edit and update the note</div>
                        </div>
                    </span>
                </label>
            </div>
        </div>

        <div class="expiry-container" id="expiryContainer">
            <div class="expiry-label">Link Expiry</div>
            <div class="expiry-options">
                <button class="expiry-option" onclick="selectExpiry(7)">7 days</button>
                <button class="expiry-option active" onclick="selectExpiry(30)">30 days</button>
                <button class="expiry-option" onclick="selectExpiry(90)">90 days</button>
                <button class="expiry-option" onclick="selectExpiry(0)">Never</button>
            </div>
        </div>

        <div class="share-link-container" id="shareLinkContainer" style="display: none;">
            <div class="share-link-label">Share Link</div>
            <div class="share-link-input-group">
                <input type="text" class="share-link-input" id="shareLinkInput" readonly>
                <button class="copy-link-btn" id="copyLinkBtn" onclick="copyShareLink()">
                    Copy
                </button>
            </div>
        </div>

        <div class="share-info">
            <p id="shareStatus">Choose your share settings:</p>
        </div>

        <div class="share-modal-actions">
            <button class="share-modal-btn cancel" onclick="closeShareModal()">Cancel</button>
            <button class="share-modal-btn unshare" id="unshareBtn" onclick="unshareNote()" style="display: none;">Remove Share Link</button>
            <button class="share-modal-btn" id="createShareBtn" onclick="createShareLink()" style="background: #3B82F6; color: white; border: none;">Create Share Link</button>
        </div>
    </div>
</div>

{% endblock %}

{% block scripts %}
<script src="{{ url_for('static', filename='scripts/brain_dump.js') }}"></script>
{% endblock %}