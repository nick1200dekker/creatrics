{% extends "base.html" %}

{% block title %}Post Magic - Create Engaging X/Twitter Content | Creatrics{% endblock %}

{% block seo_meta %}
<meta name="description" content="Create engaging social media posts with AI. Generate viral X/Twitter content, optimize for engagement, and manage your social media strategy with Creatrics AI-powered post editor.">
<meta name="keywords" content="AI social media editor, Twitter post generator, X content creator, social media AI, viral post creator">
{% endblock %}

{% block additional_styles %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/x_post_editor.css') }}">
{% endblock %}

{% block content %}
<div class="content-panel">
    <div class="post-editor-wrapper">
    <!-- Left Sidebar -->
    <aside class="drafts-sidebar">
        <div class="sidebar-header">
            <h2 class="sidebar-title">
                <i class="ph ph-pencil-simple"></i>
                Post Magic
            </h2>
            <button class="new-draft-btn" id="new-draft-button">
                <i class="ph ph-plus"></i>
                New Draft
            </button>
        </div>
        
        <div class="search-box">
            <div class="search-wrapper">
                <input type="text" 
                       class="search-input" 
                       id="searchInput" 
                       placeholder="Search drafts...">
                <i class="ph ph-magnifying-glass search-icon"></i>
            </div>
        </div>
        
        <div class="drafts-list" id="draftsList">
            <div class="drafts-loading">
                <div class="drafts-loading-spinner">
                    <i class="ph ph-spinner"></i>
                </div>
                <div>Loading drafts...</div>
            </div>
        </div>
        
        <!-- Load More Button -->
        <div class="load-more-container" id="loadMoreContainer" style="display: none;">
            <button class="load-more-btn" id="loadMoreBtn">
                <i class="ph ph-arrow-down"></i>
                <span class="load-more-text">Load More</span>
                <div class="load-more-spinner" style="display: none;">
                    <div class="spinner"></div>
                </div>
            </button>
        </div>
    </aside>
    
    <!-- Right Side - Editor Area (shown by default) -->
    <main class="editor-area" id="editorArea">
        <!-- Editor Header with Toolbar -->
        <div class="editor-header">
            <div class="editor-toolbar">
                <!-- Voice Tone Section -->
                <div class="voice-tone-section">
                    <label class="voice-tone-label">
                        <i class="ph ph-microphone"></i>
                        Voice Tone:
                    </label>
                    <div class="voice-tone-dropdown">
                        <div class="dropdown-trigger" id="voice-tone-trigger">
                            <span id="selected-voice-tone">Creatrics</span>
                            <i class="ph ph-caret-down dropdown-arrow"></i>
                        </div>
                        <div class="dropdown-menu" id="voice-tone-menu">
                            <!-- Options will be dynamically populated by JavaScript -->
                        </div>
                    </div>
                </div>

                <!-- Post Style Section -->
                <div class="post-style-section">
                    <label class="section-label">
                        <i class="ph ph-layout"></i>
                        Mode:
                    </label>
                    <div class="tools-group">
                        <button id="braindump-tool" class="ai-tool active" title="Braindump - Keywords to Post">
                            <i class="ph ph-brain"></i>
                            <span class="ai-tool-tooltip">Braindump</span>
                        </button>
                        <button id="storytelling-tool" class="ai-tool" title="Storytelling Enhancement">
                            <i class="ph ph-sparkle"></i>
                            <span class="ai-tool-tooltip">Storytelling</span>
                        </button>
                        <button id="hook-story-punch-tool" class="ai-tool" title="Hook, Story, Punch">
                            <i class="ph ph-lightning"></i>
                            <span class="ai-tool-tooltip">Hook, Story, Punch</span>
                        </button>
                        <button id="grammar-tool" class="ai-tool" title="Grammar & Style">
                            <i class="ph ph-text-a-underline"></i>
                            <span class="ai-tool-tooltip">Grammar & Style</span>
                        </button>
                        <button id="mimic-tool" class="ai-tool" title="Mimic Voice Style" style="display: none;">
                            <span style="font-weight: 700; font-size: 1rem;">M</span>
                            <span class="ai-tool-tooltip">Mimic Voice</span>
                        </button>
                    </div>
                </div>

                <!-- Execute Section -->
                <div class="execute-section">
                    <label class="section-label">
                        <i class="ph ph-play"></i>
                        Execute:
                    </label>
                    <div class="action-tools">
                        <button id="context-button" class="ai-tool" title="Add Prompt">
                            <i class="ph ph-info"></i>
                            <span class="ai-tool-tooltip">Add Prompt</span>
                        </button>
                        <button id="generate-button" class="btn btn-primary">
                            <i class="ph ph-magic-wand"></i>
                            <span class="button-text">Enhance</span>
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Editor Content -->
        <div class="editor-content">
            <div class="posts-container" id="postsContainer">
                <!-- Dynamic posts will appear here -->
            </div>
        </div>

        <!-- Editor Footer -->
        <div class="editor-footer">
            <div class="save-status saved" id="saveStatus">
                <i class="ph ph-check-circle"></i>
                <span>Saved</span>
            </div>
            <div class="editor-actions">
                <button class="action-btn" id="revert-button">
                    <i class="ph ph-arrow-counter-clockwise"></i>
                    Undo
                </button>
            </div>
        </div>
    </main>
    </div>
</div>

<!-- AI Enhancement Context Modal -->
<div class="ai-modal" id="context-modal" style="display: none;">
    <div class="ai-modal-content">
        <div class="ai-modal-header">
            <div class="ai-modal-title">
                <i class="ph ph-info"></i>
                Add Prompt
            </div>
            <button class="ai-modal-close" id="context-modal-close">
                <i class="ph ph-x"></i>
            </button>
        </div>
        <div class="ai-modal-body">
            <div class="ai-option-group">
                <label for="context-textarea" class="ai-option-label">
                    <div class="ai-option-icon">
                        <i class="ph ph-text-t"></i>
                    </div>
                    Additional Instructions
                </label>
                <textarea id="context-textarea" class="form-textarea" placeholder="Add prompts like tone, audience, or specific goals for your content..."></textarea>
            </div>
        </div>
        <div class="ai-modal-footer">
            <button class="btn btn-secondary" id="context-cancel-button">Cancel</button>
            <button class="btn btn-primary" id="context-save-button">
                <i class="ph ph-check"></i>
                Apply
            </button>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
// Pass user data to JavaScript
window.userXAccount = '{{ user.x_account | default("", true) }}';
</script>
<script src="{{ url_for('static', filename='scripts/x_post_editor.js') }}"></script>
{% endblock %}
